#!/usr/bin/env node
'use strict';

const Script = require('../src/script');
const async = require('async');
const lodash = require('lodash');
const validateUsername = require('../src/validate-username');

const rejectValid = (lines, {parallelism}, callback) => {
  const usernames = lodash.flatten(
    lines.map(line => line.split(' '))
  );

  async.rejectLimit(usernames, parallelism, validateUsername, callback);
};

module.exports = rejectValid;

if (!module.parent)
  Script.main(rejectValid);
